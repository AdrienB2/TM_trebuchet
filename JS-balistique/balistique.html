<html>
<head>
<script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
  <form id="set_variables_form"> 
    masse :<input id=mass size=20 value="1">
    angle :<input id=angle size=20 value="55">
    vitesse :<input id=speed size=20 value="1000">
    hauteur :<input id=height size=20 value="1000">
    <input type=submit>
   </form> 
<canvas style="border:1px solid black;" id="canvas"></canvas>
<script>
//récupération des inputs du formulaire ci-dessus grâce à une librairie bien pratique
$('#set_variables_form').submit(function (e) {  
  e.preventDefault();
  t=0;
  m = $('#mass').val();
  a = $('#angle').val()/180*(Math.PI);
  v = $('#speed').val()/3.6;
  h = $('#height').val()
  run();
});
//création et set-up du canvas
var canvas  = document.getElementById('canvas');
var context = canvas.getContext('2d');
var init    = {};
canvas.width = 750;
canvas.height = 500;
//table des variables
var x = 0;
var y = 0;
var k = 0;
var dx = 0;
var dy = 0;
var x0 = 0;
var g = 9.81;
var dt = 0.1;
var t = 0;
//fonctions paramétriques du mouvement
function xt(t) {
  return Math.floor(k*(1*x0 + v*Math.cos(a)*t));
}
function yt() {
  return Math.floor(canvas.height - k*(1*h + v*Math.sin(a)*t - g*t*t/2)); 
}
//dessin de la parabole
function animate(myCircle1, canvas, context) {
  myCircle1.x  = xt(t);
  myCircle1.y  = yt(t);
  context.clearRect(0, 0, canvas.width, canvas.height); //animation = après avoir fait le calcul pour t+1, on nettoie le canvas de t...
  drawCircle(myCircle1, context);
  if (myCircle1.y>canvas.height) clearInterval(init); //quand la coordonnée y<0, -> STOP
  t = t+dt;
}
//fonction lancer
function run() {
  t=0;
  var l=v*Math.cos(a);
  var p=v*Math.sin(a);
  var n=(v*Math.sin(a))**2+2*g*h;
  var d=l*(p+Math.sqrt(n));
  var myCircle1 = {x: x0, y: yt(0), mass: m};
  k = canvas.width*g/d;
  clearInterval(init);
  context.clearRect(0, 0, canvas.width, canvas.height);
  init = setInterval(function(){
    animate(myCircle1, canvas, context);
   }
  , 5); //remet à zéro la simulation
  }
//cercle sur le canvas
 function drawCircle(myCircle, context) {
  context.beginPath();
  context.arc(Math.floor(myCircle.x), Math.floor(myCircle.y), myCircle.mass, 0, 2 * Math.PI, false); //forme du cercle
  context.fillStyle = '#114'; //couleur, remplissage et épaisseur 
  context.fill();
  context.lineWidth = 5;
  context.strokeStyle = 'blue';
  context.stroke();
}
</script>
</body>
</html>  
</html>
